#!/bin/bash

set -e

# Check for special build time flags (e.g. `--enable-checksums`)
FEATURES=""
ARGS=()
for arg in "$@"; do
    if [[ "$arg" == "--enable-checksums" ]]; then
        FEATURES="--features checksum"
    else
        ARGS+=("$arg")
    fi
done

cargo build $FEATURES -p turso_whopper

time RUST_BACKTRACE=full ./target/debug/turso_whopper "${ARGS[@]}"